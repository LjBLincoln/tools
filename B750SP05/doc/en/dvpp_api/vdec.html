
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>VDEC Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters-theme.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-copy/css/copy.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="jpege.html" />
    
    
    <link rel="prev" href="cmdlist.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="introduction.html">
            
                <a href="introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="dvpp-external-apis.html">
            
                <a href="dvpp-external-apis.html">
            
                    
                    DVPP External APIs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="createdvppapi.html">
            
                <a href="createdvppapi.html">
            
                    
                    CreateDvppApi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="dvppctl.html">
            
                <a href="dvppctl.html">
            
                    
                    DvppCtl
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="new-vpc-api.html">
            
                <a href="new-vpc-api.html">
            
                    
                    New VPC API 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="old-vpc-api.html">
            
                <a href="old-vpc-api.html">
            
                    
                    Old VPC API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="cmdlist.html">
            
                <a href="cmdlist.html">
            
                    
                    CMDLIST
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2.4" data-path="vdec.html">
            
                <a href="vdec.html">
            
                    
                    VDEC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="jpege.html">
            
                <a href="jpege.html">
            
                    
                    JPEGE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="jpegd.html">
            
                <a href="jpegd.html">
            
                    
                    JPEGD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.7" data-path="pngd.html">
            
                <a href="pngd.html">
            
                    
                    PNGD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.8" data-path="venc.html">
            
                <a href="venc.html">
            
                    
                    VENC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.9" data-path="querying-dvpp-engine-capabilities.html">
            
                <a href="querying-dvpp-engine-capabilities.html">
            
                    
                    Querying DVPP Engine Capabilities
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="destroydvppapi.html">
            
                <a href="destroydvppapi.html">
            
                    
                    DestroyDvppApi
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="exception-handling.html">
            
                <a href="exception-handling.html">
            
                    
                    Exception Handling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="appendix.html">
            
                <a href="appendix.html">
            
                    
                    Appendix
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="input-parameter-structures.html">
            
                <a href="input-parameter-structures.html">
            
                    
                    Input Parameter Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="structures-in-vpc_in_msg.html">
            
                <a href="structures-in-vpc_in_msg.html">
            
                    
                    Structures in vpc_in_msg
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1.1" data-path="rawdata_overlay_config.html">
            
                <a href="rawdata_overlay_config.html">
            
                    
                    rawdata_overlay_config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.1.2" data-path="rawdata_collage_config.html">
            
                <a href="rawdata_collage_config.html">
            
                    
                    rawdata_collage_config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.1.3" data-path="rdmachannel.html">
            
                <a href="rdmachannel.html">
            
                    
                    RDMACHANNEL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.1.4" data-path="vpcturningreverse.html">
            
                <a href="vpcturningreverse.html">
            
                    
                    VpcTurningReverse
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="structures-in-vpcuserimageconfigure.html">
            
                <a href="structures-in-vpcuserimageconfigure.html">
            
                    
                    Structures in VpcUserImageConfigure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.3" data-path="structures-and-classes-in-vdec_in_msg.html">
            
                <a href="structures-and-classes-in-vdec_in_msg.html">
            
                    
                    Structures and Classes in vdec_in_msg
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.4" data-path="structures-in-image_config.html">
            
                <a href="structures-in-image_config.html">
            
                    
                    Structures in IMAGE_CONFIG
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.5" data-path="structures-in-dvpp_engine_capability_stru.html">
            
                <a href="structures-in-dvpp_engine_capability_stru.html">
            
                    
                    Structures in dvpp_engine_capability_stru
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="dvpp-executor-tool-instructions.html">
            
                <a href="dvpp-executor-tool-instructions.html">
            
                    
                    DVPP Executor Tool Instructions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="environment-preparation.html">
            
                <a href="environment-preparation.html">
            
                    
                    Environment Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="input-parameters-of-the-dvpp-executor-tool.html">
            
                <a href="input-parameters-of-the-dvpp-executor-tool.html">
            
                    
                    Input Parameters of the DVPP Executor Tool
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="vpc-instructions.html">
            
                <a href="vpc-instructions.html">
            
                    
                    VPC Instructions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.3.1" data-path="basic-functions-of-the-vpc.html">
            
                <a href="basic-functions-of-the-vpc.html">
            
                    
                    Basic Functions of the VPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3.2" data-path="vpc-raw-data-8k.html">
            
                <a href="vpc-raw-data-8k.html">
            
                    
                    VPC Raw Data 8K
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="cmdlist-instructions.html">
            
                <a href="cmdlist-instructions.html">
            
                    
                    CMDLIST Instructions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.5" data-path="vdec-instructions.html">
            
                <a href="vdec-instructions.html">
            
                    
                    VDEC Instructions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6" data-path="venc-instructions.html">
            
                <a href="venc-instructions.html">
            
                    
                    VENC Instructions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.7" data-path="jpege-instructions.html">
            
                <a href="jpege-instructions.html">
            
                    
                    JPEGE Instructions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.8" data-path="jpegd-instructions.html">
            
                <a href="jpegd-instructions.html">
            
                    
                    JPEGD Instructions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.9" data-path="pngd-instructions.html">
            
                <a href="pngd-instructions.html">
            
                    
                    PNGD Instructions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="acronyms-and-abbreviations.html">
            
                <a href="acronyms-and-abbreviations.html">
            
                    
                    Acronyms and Abbreviations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="auxiliary-function-apis.html">
            
                <a href="auxiliary-function-apis.html">
            
                    
                    Auxiliary Function APIs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="list-of-apis-that-are-not-recommended.html">
            
                <a href="list-of-apis-that-are-not-recommended.html">
            
                    
                    List of APIs that Are Not Recommended
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >VDEC</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="vdec">VDEC<a id="EN-US_TOPIC_0133344605"></a></h1>
<h2 id="function">Function<a id="section1452418150919"></a></h2>
<p>The VDEC module is used to decode video.</p>
<ul>
<li><p>The VDEC supports the following input formats:</p>
<p>H.264 BP/MP/HP Level 5.1 YUV420sp encoded streams</p>
<p>H.265 8-/10-bit Level 5.1 YUV420sp encoded streams</p>
</li>
<li><p>The VDEC output format is: HFBC data after YUV420sp compression</p>
</li>
</ul>
<h2 id="performance-specifications-of-the-vdec">Performance Specifications of the VDEC<a id="section1358915016103"></a></h2>
<p><a id="table4179193581715"></a></p>
<table><thead align="left"><tr id="row71901935201711"><th class="cellrowborder" valign="top" width="50%" id="mcps1.1.3.1.1"><p id="p1420115616174"><a id="p1420115616174"></a><a id="p1420115616174"></a>Scene</p>
</th>
<th class="cellrowborder" valign="top" width="50%" id="mcps1.1.3.1.2"><p id="p2198435101713"><a id="p2198435101713"></a><a id="p2198435101713"></a>Total Frame Rate</p>
</th>
</tr>
</thead>
<tbody><tr id="row6202103521717"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.1 "><p id="p1420603516176"><a id="p1420603516176"></a><a id="p1420603516176"></a>1080p, two or more processes (no limit on the number of processes)</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.2 "><p id="p420953531714"><a id="p420953531714"></a><a id="p420953531714"></a>480 fps</p>
</td>
</tr>
<tr id="row202111435131714"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.1 "><p id="p417812431917"><a id="p417812431917"></a><a id="p417812431917"></a>1080p, single process (2 &#x2264; Number of threads &#x2264; 16)</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.2 "><p id="p15218035101710"><a id="p15218035101710"></a><a id="p15218035101710"></a>320 fps</p>
</td>
</tr>
<tr id="row830317025617"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.1 "><p id="p510118675619"><a id="p510118675619"></a><a id="p510118675619"></a>1080p, single process, single thread</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.2 "><p id="p11304401567"><a id="p11304401567"></a><a id="p11304401567"></a>240 fps</p>
</td>
</tr>
<tr id="row52127188198"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.1 "><p id="p32121118121919"><a id="p32121118121919"></a><a id="p32121118121919"></a>4K, two or more processes (no limit on the number of processes)</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.2 "><p id="p12131718111912"><a id="p12131718111912"></a><a id="p12131718111912"></a>120 fps</p>
</td>
</tr>
<tr id="row1930793518247"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.1 "><p id="p753183016565"><a id="p753183016565"></a><a id="p753183016565"></a>4K, single process (2 &#x2264; Number of threads &#x2264; 16)</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.2 "><p id="p11307193518248"><a id="p11307193518248"></a><a id="p11307193518248"></a>80 fps</p>
</td>
</tr>
<tr id="row1929144135618"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.1 "><p id="p44531550165617"><a id="p44531550165617"></a><a id="p44531550165617"></a>4K, single process, single thread</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.1.3.1.2 "><p id="p12929744115612"><a id="p12929744115612"></a><a id="p12929744115612"></a>60 fps</p>
</td>
</tr>
</tbody>
</table>

<p>Since the VDEC module does not use the singleton pattern, it provides external C interface functions different from other modules.</p>
<h2 id="c-interface-functions-provided-by-the-vdec-externally">C Interface Functions Provided by the VDEC Externally<a id="section1839024071014"></a></h2>
<ul>
<li><p><strong>int CreateVdecApi(IDVPPAPI *&amp;pIDVPPAPI, int singleton)</strong></p>
<p><a id="table1382461034619"></a></p>
<table><tbody><tr id="row1382251074618"><th class="firstcol" valign="top" width="20.07%" id="mcps1.1.3.1.1"><p id="p782151017461"><a id="p782151017461"></a><a id="p782151017461"></a>Prototype</p>
</th>
<td class="cellrowborder" valign="top" width="79.93%" headers="mcps1.1.3.1.1 "><p id="p582219108467"><a id="p582219108467"></a><a id="p582219108467"></a><strong id="b131210516114"><a id="b131210516114"></a><a id="b131210516114"></a>int CreateVdecApi(IDVPPAPI *&amp;pIDVPPAPI, int singleton)</strong></p>
</td>
</tr>
<tr id="row18822410114611"><th class="firstcol" valign="top" width="20.07%" id="mcps1.1.3.2.1"><p id="p108229102467"><a id="p108229102467"></a><a id="p108229102467"></a>Function</p>
</th>
<td class="cellrowborder" valign="top" width="79.93%" headers="mcps1.1.3.2.1 "><p id="p1982217105461"><a id="p1982217105461"></a><a id="p1982217105461"></a>Obtains a VDEC API instance, which is equivalent to the handle to the VDEC executor. The caller can use the applied VDEC API instance to invoke the VDEC module, either across functions or across threads. The caller is responsible for the life cycle of the VDEC API instance, including the application and release, which are implemented by using the CreateVdecApi function and the DestroyVdecApi, respectively.</p>
</td>
</tr>
<tr id="row38221610164620"><th class="firstcol" valign="top" width="20.07%" id="mcps1.1.3.3.1"><p id="p1182291015462"><a id="p1182291015462"></a><a id="p1182291015462"></a>Input Description</p>
</th>
<td class="cellrowborder" valign="top" width="79.93%" headers="mcps1.1.3.3.1 "><p id="p1582211011461"><a id="p1582211011461"></a><a id="p1582211011461"></a>The input is the <strong id="b1782213105462"><a id="b1782213105462"></a><a id="b1782213105462"></a>IDVPPAPI</strong> pointer reference. The input pointer must be <strong id="b8801864381"><a id="b8801864381"></a><a id="b8801864381"></a>NULL</strong>.</p>
<p id="p138229107460"><a id="p138229107460"></a><a id="p138229107460"></a>The input singleton is reserved for internal use to implement a single pIDVPPAPI instance in the future. It is recommended that the caller set the parameter to<strong id="b387213542120"><a id="b387213542120"></a><a id="b387213542120"></a> 0</strong> currently.</p>
</td>
</tr>
<tr id="row9823201024620"><th class="firstcol" valign="top" width="20.07%" id="mcps1.1.3.4.1"><p id="p128222010184619"><a id="p128222010184619"></a><a id="p128222010184619"></a>Output Description</p>
</th>
<td class="cellrowborder" valign="top" width="79.93%" headers="mcps1.1.3.4.1 "><p id="p882381014468"><a id="p882381014468"></a><a id="p882381014468"></a>The output is the <strong id="b20823141014461"><a id="b20823141014461"></a><a id="b20823141014461"></a>IDVPPAPI</strong> pointer reference. The output pointer may be or may not be <strong id="b15904203384412"><a id="b15904203384412"></a><a id="b15904203384412"></a>NULL</strong>. If a DVPP API instance fails to be obtained, the output pointer is <strong id="b18904933164420"><a id="b18904933164420"></a><a id="b18904933164420"></a>NULL</strong>. If a DVPP API instance is successfully obtained, the output pointer is not <strong id="b1790493334416"><a id="b1790493334416"></a><a id="b1790493334416"></a>NULL</strong>.</p>
</td>
</tr>
<tr id="row108231810194620"><th class="firstcol" valign="top" width="20.07%" id="mcps1.1.3.5.1"><p id="p13823171018462"><a id="p13823171018462"></a><a id="p13823171018462"></a>Return Value</p>
</th>
<td class="cellrowborder" valign="top" width="79.93%" headers="mcps1.1.3.5.1 "><p id="p98231110194610"><a id="p98231110194610"></a><a id="p98231110194610"></a>The return value <span class="parmvalue" id="parmvalue580014225397"><a id="parmvalue580014225397"></a><a id="parmvalue580014225397"></a><b>0</b></span> indicates success, while <span class="parmvalue" id="parmvalue17800122113911"><a id="parmvalue17800122113911"></a><a id="parmvalue17800122113911"></a><b>&#x2013;1</b></span> indicates failure.</p>
</td>
</tr>
<tr id="row282491016464"><th class="firstcol" valign="top" width="20.07%" id="mcps1.1.3.6.1"><p id="p13823510154610"><a id="p13823510154610"></a><a id="p13823510154610"></a>Remarks</p>
</th>
<td class="cellrowborder" valign="top" width="79.93%" headers="mcps1.1.3.6.1 "><p id="p5824131004616"><a id="p5824131004616"></a><a id="p5824131004616"></a>The caller creates the <strong id="b20823510114617"><a id="b20823510114617"></a><a id="b20823510114617"></a>IDVPPAPI</strong> object pointer, which is initialized to <strong id="b13191535183912"><a id="b13191535183912"></a><a id="b13191535183912"></a>NULL</strong>. The <strong id="b3823191014619"><a id="b3823191014619"></a><a id="b3823191014619"></a>IDVPPAPI</strong> object pointer is transferred by calling the CreateVdecApi function. If the application is successful, the CreateVdecApi function returns the DVPP API instance. Otherwise, <strong id="b1052210934014"><a id="b1052210934014"></a><a id="b1052210934014"></a>NULL</strong> is returned. The caller needs to verify the return value.</p>
</td>
</tr>
<tr id="row88241710144613"><th class="firstcol" valign="top" width="20.07%" id="mcps1.1.3.7.1"><p id="p168240108460"><a id="p168240108460"></a><a id="p168240108460"></a>Restrictions</p>
</th>
<td class="cellrowborder" valign="top" width="79.93%" headers="mcps1.1.3.7.1 "><p id="p19824191017466"><a id="p19824191017466"></a><a id="p19824191017466"></a>This function is one of the unified calling APIs provided by the VDEC externally and is used to obtain the handle to the VDEC executor.</p>
</td>
</tr>
</tbody>
</table>
</li>
<li><p><strong>int VdecCtl(IDVPPAPI *&amp;pIDVPPAPI, int CMD, dvppapi_ctl_msg *MSG, int singleton)</strong></p>
<p><a id="table3803154464516"></a></p>
<table><tbody><tr id="row1787624464520"><th class="firstcol" valign="top" width="24.73%" id="mcps1.1.3.1.1"><p id="p887604454511"><a id="p887604454511"></a><a id="p887604454511"></a>Prototype</p>
</th>
<td class="cellrowborder" valign="top" width="75.27000000000001%" headers="mcps1.1.3.1.1 "><p id="p13876124416452"><a id="p13876124416452"></a><a id="p13876124416452"></a><strong id="b7157161261211"><a id="b7157161261211"></a><a id="b7157161261211"></a>int VdecCtl(IDVPPAPI *&amp;pIDVPPAPI, int CMD, dvppapi_ctl_msg *MSG, int singleton)</strong></p>
</td>
</tr>
<tr id="row8876154464512"><th class="firstcol" valign="top" width="24.73%" id="mcps1.1.3.2.1"><p id="p1876124415455"><a id="p1876124415455"></a><a id="p1876124415455"></a>Function</p>
</th>
<td class="cellrowborder" valign="top" width="75.27000000000001%" headers="mcps1.1.3.2.1 "><p id="p88761144144519"><a id="p88761144144519"></a><a id="p88761144144519"></a>Controls the DVPP executor to perform video decoding.</p>
</td>
</tr>
<tr id="row1587674494517"><th class="firstcol" valign="top" width="24.73%" id="mcps1.1.3.3.1"><p id="p10876204424518"><a id="p10876204424518"></a><a id="p10876204424518"></a>Input Description</p>
</th>
<td class="cellrowborder" valign="top" width="75.27000000000001%" headers="mcps1.1.3.3.1 "><p id="p9877204434513"><a id="p9877204434513"></a><a id="p9877204434513"></a>The <strong id="b9964114684115"><a id="b9964114684115"></a><a id="b9964114684115"></a>IDVPPAPI</strong> pointer reference is input.</p>
<p id="p38771044184518"><a id="p38771044184518"></a><a id="p38771044184518"></a>For the VDEC module, the control command word (CMD) is DVPP_CTL_VDEC_PROC.</p>
<p id="p138777442458"><a id="p138777442458"></a><a id="p138777442458"></a>The type of the VDEC executor configuration information (MSG) is <strong id="b1231718321097"><a id="b1231718321097"></a><a id="b1231718321097"></a>dvppapi_ctl_msg</strong>. For details about<strong id="b66614581919"><a id="b66614581919"></a><a id="b66614581919"></a> in</strong> and <strong id="b10364514102"><a id="b10364514102"></a><a id="b10364514102"></a>out</strong> in this structure, see <a href="#section1837272115511">Input Parameter: vdec_in_msg</a> and <a href="#section8185641267">Output Parameter: vdec_out_msg</a>.</p>
<p id="p14877164413454"><a id="p14877164413454"></a><a id="p14877164413454"></a>The input singleton is reserved for internal use to implement a single pIDVPPAPI instance in the future. It is recommended that the caller set the parameter to<strong id="b1536919151423"><a id="b1536919151423"></a><a id="b1536919151423"></a> 0</strong> currently.</p>
</td>
</tr>
<tr id="row88771744104517"><th class="firstcol" valign="top" width="24.73%" id="mcps1.1.3.4.1"><p id="p18877164410450"><a id="p18877164410450"></a><a id="p18877164410450"></a>Output Description</p>
</th>
<td class="cellrowborder" valign="top" width="75.27000000000001%" headers="mcps1.1.3.4.1 "><p id="p1877134444512"><a id="p1877134444512"></a><a id="p1877134444512"></a>The output consists of the output buffer in the configuration information (MSG) and the output status information of the VDEC (which is all stored in the MSG).</p>
</td>
</tr>
<tr id="row28771444104515"><th class="firstcol" valign="top" width="24.73%" id="mcps1.1.3.5.1"><p id="p1687734419459"><a id="p1687734419459"></a><a id="p1687734419459"></a>Return Value</p>
</th>
<td class="cellrowborder" valign="top" width="75.27000000000001%" headers="mcps1.1.3.5.1 "><p id="p38771044104510"><a id="p38771044104510"></a><a id="p38771044104510"></a>The return value <span class="parmvalue" id="parmvalue1598051914214"><a id="parmvalue1598051914214"></a><a id="parmvalue1598051914214"></a><b>0</b></span> indicates success, while <span class="parmvalue" id="parmvalue16980161914426"><a id="parmvalue16980161914426"></a><a id="parmvalue16980161914426"></a><b>&#x2013;1</b></span> indicates failure.</p>
</td>
</tr>
<tr id="row7877344174520"><th class="firstcol" valign="top" width="24.73%" id="mcps1.1.3.6.1"><p id="p12877844184514"><a id="p12877844184514"></a><a id="p12877844184514"></a>Remarks</p>
</th>
<td class="cellrowborder" valign="top" width="75.27000000000001%" headers="mcps1.1.3.6.1 "><p id="p487794414519"><a id="p487794414519"></a><a id="p487794414519"></a>The caller calls the VdecCtl function to transfer the IDVPPAPI object pointer, configures the dvppapi_ctl_msg of the corresponding function, and transfers the correct control command word (CMD).</p>
</td>
</tr>
<tr id="row10877124416454"><th class="firstcol" valign="top" width="24.73%" id="mcps1.1.3.7.1"><p id="p387716448453"><a id="p387716448453"></a><a id="p387716448453"></a>Restrictions</p>
</th>
<td class="cellrowborder" valign="top" width="75.27000000000001%" headers="mcps1.1.3.7.1 "><p id="p1187713446458"><a id="p1187713446458"></a><a id="p1187713446458"></a>This function is one of the unified calling APIs provided by the VDEC externally and is used to call specific functions of the VDEC executor.</p>
</td>
</tr>
</tbody>
</table>
</li>
<li><p><strong>int DestroyVdecApi(IDVPPAPI *&amp;pIDVPPAPI, int singleton)</strong></p>
<p><a id="table183641355124511"></a></p>
<table><tbody><tr id="row144215554458"><th class="firstcol" valign="top" width="21.34%" id="mcps1.1.3.1.1"><p id="p1942185524516"><a id="p1942185524516"></a><a id="p1942185524516"></a>Prototype</p>
</th>
<td class="cellrowborder" valign="top" width="78.66%" headers="mcps1.1.3.1.1 "><p id="p1942125517459"><a id="p1942125517459"></a><a id="p1942125517459"></a><strong id="b10208831121215"><a id="b10208831121215"></a><a id="b10208831121215"></a>int DestroyVdecApi(IDVPPAPI *&amp;pIDVPPAPI, int singleton)</strong></p>
</td>
</tr>
<tr id="row3421135517452"><th class="firstcol" valign="top" width="21.34%" id="mcps1.1.3.2.1"><p id="p1242195518456"><a id="p1242195518456"></a><a id="p1242195518456"></a>Function</p>
</th>
<td class="cellrowborder" valign="top" width="78.66%" headers="mcps1.1.3.2.1 "><p id="p184217556452"><a id="p184217556452"></a><a id="p184217556452"></a>Releases the VDEC API and disables the VDEC executor.</p>
</td>
</tr>
<tr id="row1842119559458"><th class="firstcol" valign="top" width="21.34%" id="mcps1.1.3.3.1"><p id="p15421165574516"><a id="p15421165574516"></a><a id="p15421165574516"></a>Input Description</p>
</th>
<td class="cellrowborder" valign="top" width="78.66%" headers="mcps1.1.3.3.1 "><p id="p642125584518"><a id="p642125584518"></a><a id="p642125584518"></a>The <strong id="b137101514102218"><a id="b137101514102218"></a><a id="b137101514102218"></a>IDVPPAPI</strong> pointer reference is input.</p>
<p id="p14221655184514"><a id="p14221655184514"></a><a id="p14221655184514"></a>The input singleton is reserved for internal use to implement a single pIDVPPAPI instance in the future. It is recommended that the caller set the parameter to<strong id="b12275334411"><a id="b12275334411"></a><a id="b12275334411"></a> 0</strong> currently.</p>
</td>
</tr>
<tr id="row642217554454"><th class="firstcol" valign="top" width="21.34%" id="mcps1.1.3.4.1"><p id="p17422105512459"><a id="p17422105512459"></a><a id="p17422105512459"></a>Output Description</p>
</th>
<td class="cellrowborder" valign="top" width="78.66%" headers="mcps1.1.3.4.1 "><p id="p17422175544518"><a id="p17422175544518"></a><a id="p17422175544518"></a>There is no output.</p>
</td>
</tr>
<tr id="row134229557454"><th class="firstcol" valign="top" width="21.34%" id="mcps1.1.3.5.1"><p id="p94223553453"><a id="p94223553453"></a><a id="p94223553453"></a>Return Value</p>
</th>
<td class="cellrowborder" valign="top" width="78.66%" headers="mcps1.1.3.5.1 "><p id="p1142275564514"><a id="p1142275564514"></a><a id="p1142275564514"></a>The return value <span class="parmvalue" id="parmvalue1248012715377"><a id="parmvalue1248012715377"></a><a id="parmvalue1248012715377"></a><b>0</b></span> indicates success, while <span class="parmvalue" id="parmvalue1148016719376"><a id="parmvalue1148016719376"></a><a id="parmvalue1148016719376"></a><b>&#x2013;1</b></span> indicates failure.</p>
</td>
</tr>
<tr id="row184221555194518"><th class="firstcol" valign="top" width="21.34%" id="mcps1.1.3.6.1"><p id="p242265524520"><a id="p242265524520"></a><a id="p242265524520"></a>Remarks</p>
</th>
<td class="cellrowborder" valign="top" width="78.66%" headers="mcps1.1.3.6.1 "><p id="p44221255194515"><a id="p44221255194515"></a><a id="p44221255194515"></a>None</p>
</td>
</tr>
<tr id="row74221955194519"><th class="firstcol" valign="top" width="21.34%" id="mcps1.1.3.7.1"><p id="p442255519459"><a id="p442255519459"></a><a id="p442255519459"></a>Restrictions</p>
</th>
<td class="cellrowborder" valign="top" width="78.66%" headers="mcps1.1.3.7.1 "><p id="p10422145517457"><a id="p10422145517457"></a><a id="p10422145517457"></a>This function is a unified calling API provided by the VDEC externally and is used to release the VDEC execution resources.</p>
</td>
</tr>
</tbody>
</table>

</li>
</ul>
<h2 id="input-parameter-vdecinmsg">Input Parameter: vdec_in_msg<a id="section1837272115511"></a></h2>
<p><a id="table3188092"></a></p>
<table><thead align="left"><tr id="row99438"><th class="cellrowborder" valign="top" width="41.46%" id="mcps1.1.3.1.1"><p id="p8054535"><a id="p8054535"></a><a id="p8054535"></a>Member Variable</p>
</th>
<th class="cellrowborder" valign="top" width="58.540000000000006%" id="mcps1.1.3.1.2"><p id="p48437568"><a id="p48437568"></a><a id="p48437568"></a>Description</p>
</th>
</tr>
</thead>
<tbody><tr id="row33284928"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p682632045419"><a id="p682632045419"></a><a id="p682632045419"></a>char video_format[10]</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p158268205549"><a id="p158268205549"></a><a id="p158268205549"></a>Input video format, for example, H.264 or H.265. The default value is <strong id="b181611142612"><a id="b181611142612"></a><a id="b181611142612"></a>H.264</strong>.</p>
<p id="p8826102010546"><a id="p8826102010546"></a><a id="p8826102010546"></a>Only the H.264 and H.265 streams encoded by YUV420sp (NV12 and NV21) are supported.</p>
</td>
</tr>
<tr id="row18479019"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p282618202540"><a id="p282618202540"></a><a id="p282618202540"></a>char image_format[10]</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p10826132018540"><a id="p10826132018540"></a><a id="p10826132018540"></a>Output frame format, for example, NV12 or NV21. The default value is <strong id="b72062038272"><a id="b72062038272"></a><a id="b72062038272"></a>NV12</strong>.</p>
</td>
</tr>
<tr id="row0381151261916"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p16827102055414"><a id="p16827102055414"></a><a id="p16827102055414"></a>void (*call_back)(FRAME* frame,void * hiai_data)</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p482720204545"><a id="p482720204545"></a><a id="p482720204545"></a>Callback function. <strong id="b1965474664411"><a id="b1965474664411"></a><a id="b1965474664411"></a>FRAME</strong> is the output structure after VDEC decoding. For details, see<a href="structures-and-classes-in-vdec_in_msg.html#li491075611222"> FRAME Structure</a>.</p>
</td>
</tr>
<tr id="row44610175"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p5826102095418"><a id="p5826102095418"></a><a id="p5826102095418"></a>char* in_buffer</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p2826102018542"><a id="p2826102018542"></a><a id="p2826102018542"></a>Buffer of input H.264 or H.265 raw video streams</p>
</td>
</tr>
<tr id="row29150243"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p14827172065417"><a id="p14827172065417"></a><a id="p14827172065417"></a>int in_buffer_size</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p158271120165413"><a id="p158271120165413"></a><a id="p158271120165413"></a>Buffer size of input video streams</p>
</td>
</tr>
<tr id="row17470274"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p7827192075410"><a id="p7827192075410"></a><a id="p7827192075410"></a>void * hiai_data</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p198271320115417"><a id="p198271320115417"></a><a id="p198271320115417"></a>Pointer to the formal parameter of the output frame callback function after decoding. The object that the pointer points to is defined by the caller.</p>
<div class="notice" id="note1111364310147"><a id="note1111364310147"></a><a id="note1111364310147"></a><span class="noticetitle"> NOTICE: </span><div class="noticebody"><p id="p011318434146"><a id="p011318434146"></a><a id="p011318434146"></a>Only hiai_data that is transferred to the VDEC for the first time is called. To use hiai_data to transfer different objects multiple times, use the following smart pointer object.</p>
</div></div>
</td>
</tr>
<tr id="row1581218531514"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p1694361615158"><a id="p1694361615158"></a><a id="p1694361615158"></a>std::shared_ptr&lt;HIAI_DATA_SP&gt; hiai_data_sp</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p174831821121512"><a id="p174831821121512"></a><a id="p174831821121512"></a>Pointer to the formal parameter of the callback function. <strong id="b16756142823511"><a id="b16756142823511"></a><a id="b16756142823511"></a>HIAI_DATA_SP </strong>is the parent class defined in the VDEC. For details, see <a href="structures-and-classes-in-vdec_in_msg.html#li136402167299">HIAI_DATA_SP Class</a>. You can inherit the derived subclasses. For details, see the sample code in section 3.3.2.7. In the class that the pointer points to, you can set the information such as the frame sequence number. However, only one frame can correspond to one frame sequence number.</p>
<div class="notice" id="note8888727191512"><a id="note8888727191512"></a><a id="note8888727191512"></a><span class="noticetitle"> NOTICE: </span><div class="noticebody"><p id="p2889162771512"><a id="p2889162771512"></a><a id="p2889162771512"></a>The use of the hiai_data_sp smart pointer shields hiai_data. That is, you can only select either hiai_data_sp or hiai_data.</p>
</div></div>
</td>
</tr>
<tr id="row4165138195414"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p1865463122013"><a id="p1865463122013"></a><a id="p1865463122013"></a>int channelId</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p86568311201"><a id="p86568311201"></a><a id="p86568311201"></a>ID of the decoding channel corresponding to the input stream. Different values must be set when different streams are decoded at the same time. The value range is 0&#x2013;15.</p>
</td>
</tr>
<tr id="row431365915194"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p265619392011"><a id="p265619392011"></a><a id="p265619392011"></a>void (*err_report)(VDECERR* vdecErr)</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p18656433209"><a id="p18656433209"></a><a id="p18656433209"></a>Error reporting callback function, which is used to notify you of exceptions that occur during decoding, such as stream errors, hardware faults, and decoder status errors, so that you can determine how to handle the exceptions. The formal parameter VDECERR is the internal definition structure of the VDEC. For details, see<a href="structures-and-classes-in-vdec_in_msg.html#li12283759122315"> VDECERR Structure</a>.</p>
</td>
</tr>
<tr id="row2188624200"><td class="cellrowborder" valign="top" width="41.46%" headers="mcps1.1.3.1.1 "><p id="p16571235207"><a id="p16571235207"></a><a id="p16571235207"></a>bool isEOS</p>
</td>
<td class="cellrowborder" valign="top" width="58.540000000000006%" headers="mcps1.1.3.1.2 "><p id="p166577322017"><a id="p166577322017"></a><a id="p166577322017"></a>End of stream (EOS) flag, indicating that the decoding of the current channel is complete. You do not need to pay attention to this flag. By default, <strong id="b9965711175014"><a id="b9965711175014"></a><a id="b9965711175014"></a>isEOS</strong> is set to <strong id="b8811120105013"><a id="b8811120105013"></a><a id="b8811120105013"></a>true</strong> in the DestroyVdecApi interface so that resources are released when the decoding of the channel ends. If <strong id="b45495213519"><a id="b45495213519"></a><a id="b45495213519"></a>isEOS</strong> is set to <strong id="b126392517512"><a id="b126392517512"></a><a id="b126392517512"></a>true</strong>, the user configuration is preferentially used in the calling of the VdecCtl interface so that resources are released when the decoding of the channel ends. For details, see <a href="#section73807121568">Calling Example</a>.</p>
</td>
</tr>
</tbody>
</table>

<h2 id="output-parameter-vdecoutmsg">Output Parameter: vdec_out_msg<a id="section8185641267"></a></h2>
<p>None. For details about the output, see  <a href="structures-and-classes-in-vdec_in_msg.html">Structures and Classes in vdec_in_msg</a><a href="structures-and-classes-in-vdec_in_msg.html#li491075611222">FRAME Structure</a>. You can obtain the VDEC output by reading the buffer.</p>
<h2 id="calling-example">Calling Example<a id="section73807121568"></a></h2>
<p>Note: In this example, the H.264 stream file named  <strong>test_file</strong>  is read, the VDEC function is called, and the decoding result is saved to the  <strong>output_dir</strong>  directory.</p>
<pre><code>// Self-defined subclass. In this example code, the parent class is inherited to implement the destructor. There is no other change.
class HIAI_DATA_SP_SON: public HIAI_DATA_SP
{
public:
           ~ HIAI_DATA_SP_SON ()
           {
               //destruct here;
           }
};

IDVPPAPI * pidvppapi_vpc = NULL; 
IDVPPAPI * pidvppapi_vdec = NULL;

// The callback function is used as an example. The caller needs to redefine the callback function as required.
void frame_return(FRAME * frame,void * hiai_data)
{
    static int image_cnt = 0;
    image_cnt++;
    printf(&quot;call save frame number:[%d], width:[%d], height:[%d]\n&quot;, image_cnt, frame-&gt;width, frame-&gt;height);

    if(hiai_data != NULL){
           // If a smart pointer is used, the pointer needs to be converted to a user-defined class pointer. If the pointer is a common pointer, convert the pointer to a user-defined structure type.
            HIAI_DATA_SP_SON * hiai_data_sp = (HIAI_DATA_SP_SON*) hiai_data;
            printf(&quot;frame index : %d\n&quot;, hiai_data_sp-&gt;getFrameIndex());
    }

    //call vpc interface to decompress hfbc
    printf(&quot;call vpc interface\n&quot;);
    if (pidvppapi_vpc != NULL) {
        dvppapi_ctl_msg dvppApiCtlMsg;
        vpc_in_msg vpcInMsg;
        vpcInMsg.format = 0;  //YUV420_SEMI_PLANNAR=0
        vpcInMsg.rank = 1;    //nv12 =0 ,nv21 =1
        vpcInMsg.bitwidth = frame-&gt;bitdepth;
        vpcInMsg.width = frame-&gt;width;
        vpcInMsg.high = frame-&gt;height;
        shared_ptr&lt;AutoBuffer&gt; auto_out_buffer = make_shared&lt;AutoBuffer&gt;();     
        vpcInMsg.in_buffer = (char *)frame-&gt;buffer;
        vpcInMsg.in_buffer_size = frame-&gt;buffer_size;       
        vpcInMsg.rdma.luma_head_addr = (long)(frame-&gt;buffer + frame-&gt;offset_head_y);
        vpcInMsg.rdma.chroma_head_addr = (long)(frame-&gt;buffer + frame-&gt;offset_head_c);      
        vpcInMsg.rdma.luma_payload_addr = (long)(frame-&gt;buffer + frame-&gt;offset_payload_y);
        vpcInMsg.rdma.chroma_payload_addr = (long)(frame-&gt;buffer + frame-&gt;offset_payload_c);        
        vpcInMsg.rdma.luma_head_stride = frame-&gt;stride_head;
        vpcInMsg.rdma.chroma_head_stride = frame-&gt;stride_head;
        vpcInMsg.rdma.luma_payload_stride = frame-&gt;stride_payload;
        vpcInMsg.rdma.chroma_payload_stride = frame-&gt;stride_payload;
        vpcInMsg.cvdr_or_rdma = 0;      
        vpcInMsg.hmax = frame-&gt;realWidth-1;
        vpcInMsg.hmin = 0;
        vpcInMsg.vmax = frame-&gt;realHeight-1;
        vpcInMsg.vmin = 0;
        vpcInMsg.vinc = 1;
        vpcInMsg.hinc = 1;      
        vpcInMsg.auto_out_buffer_1 = auto_out_buffer;
        dvppApiCtlMsg.in = (void*)(&amp;vpcInMsg);
        dvppApiCtlMsg.in_size = sizeof(vpc_in_msg);     

        if (DvppCtl(pidvppapi_vpc,DVPP_CTL_VPC_PROC,&amp;dvppApiCtlMsg) != 0) {
           printf(&quot;call dvppctl fail\n&quot;);
            return;
        }

        char filename_vpc[30];
        int ret = memset_s(filename_vpc, 30, 0, 30);
        if (ret != 0) {
            printf(&quot;memset_s fail\n&quot;);
        }

        ret = strncpy_s(filename_vpc, sizeof(filename_vpc), &quot;output_dir/image_vpc&quot;, strlen(&quot;output_dir/image_vpc&quot;));
        if (ret != 0) {
            printf(&quot;strncpy_s fail\n&quot;);
            return;
        }

        ret = sprintf_s(filename_vpc + strlen(&quot;output_dir/image_vpc&quot;), sizeof(filename_vpc) - strlen(&quot;output_dir/image_vpc&quot;), &quot;%d&quot;,image_cnt);
        if (ret == -1) {
            printf(&quot;sprintf_s fail\n&quot;);
            return;
        }

        FILE *fp_vpc = NULL;
        fp_vpc = fopen(filename_vpc, &quot;wb+&quot;);
        if (fp_vpc == NULL) {
            printf(&quot;open file %s failed~\n&quot;, filename_vpc);
            return;
        }
        fwrite(vpcInMsg.auto_out_buffer_1-&gt;getBuffer(), 1, vpcInMsg.auto_out_buffer_1-&gt;getBufferSize(), fp_vpc);
        fflush(fp_vpc);
        fclose(fp_vpc);
        printf(&quot;save vpc result:%s, write size: %d\n&quot;,filename_vpc, vpcInMsg.auto_out_buffer_1-&gt;getBufferSize());
           }
           else {
            printf(&quot;create vpc fail\n&quot;);
           }
    DestroyDvppApi(pidvppapi_vpc);
    return;
}
// Main entry of the test function
int main()
{
    char output_dir[20];
    int ret = 0;
    ret = memset_s(output_dir, 20, 0, 20);
    if (ret != 0) {
        printf(&quot;memset_s fail\n&quot;);
        return;
    }

    ret = strncpy_s(output_dir, sizeof(output_dir), &quot;output_dir&quot;, strlen(&quot;output_dir&quot;));
    if (ret !=0) {
        printf(&quot;strncpy_s fail\n&quot;);
        return;
    }

    if (access(output_dir, 0) == -1) {
        if (mkdir(output_dir, S_IREAD | S_IWRITE) &lt; 0) {
            printf(&quot;create dir failed.\n&quot;);
            return;
        }
    }

          // Initialize VPC instance objects.
           ret = CreateDvppApi(pidvppapi_vpc);
          // Initialize VDEC instance objects.
           ret = CreateVdecApi(pidvppapi_vdec, 0);

           if(ret == 0 &amp;&amp; pidvppapi_vpc != NULL &amp;&amp; pidvppapi_vdec != NULL){
            FILE* fp = fopen(in_file_name,&quot;rb&quot;);
            if(fp != NULL){
                  fseek(fp,0L,SEEK_END);
                  int file_size = ftell(fp);
                  fseek(fp,0L,SEEK_SET); 
                  int rest_len=file_size;
                  int len = file_size;//2*1024*1024;

                  vdec_in_msg vdec_msg;
                // User-defined frame_return function. For details, see the example of the preceding frame_return function.
                   vdec_msg.call_back = frame_return;
                 // User-defined hiai_data structure. This parameter is not used here and is therefore set to NULL.
                   vdec_msg.hiai_data = NULL;
                // Set the ID of the decoding channel.
                   vdec_msg.channelId = 0;
                // Set the protocol type of a stream.
                   if(gFormat == 0){
                         memcpy(vdec_msg.video_format,&quot;h264&quot;,4);
                   }else{
                         memcpy(vdec_msg.video_format,&quot;h265&quot;,4);
                  }
                 // Set the output format type. The value is NV12.
                   memcpy(vdec_msg.image_format,&quot;nv12&quot;,4);
                 // Allocate the buffer for storing streams.
                  vdec_msg.in_buffer = (char*)malloc(len);
                  if(vdec_msg.in_buffer != NULL){                
                         dvppapi_ctl_msg dvppApiCtlMsg;
                         dvppApiCtlMsg.in = (void*)(&amp;vdec_msg);
                         dvppApiCtlMsg.in_size = sizeof(vdec_in_msg);   

                         int cnt = 0;
                         while(rest_len&gt;0){
                                int read_len = fread(vdec_msg.in_buffer,1,len,fp);
                                printf(&quot;rest_len is %d,read len is %d.\n&quot;,rest_len,read_len);
                                vdec_msg.in_buffer_size = read_len;
                               // The following three lines are used to define the hiai_data_sp object and set the frame sequence number. You can skip them if you do not need them.
                                std::shared_ptr&lt; HIAI_DATA_SP_SON&gt; dc_sp = make_shared&lt; HIAI_DATA_SP_SON&gt;();
                                dc_sp-&gt;setFrameIndex(++cnt);
                                vdec_msg.hiai_data_sp = dc_sp;
                               // Set the ID of the decoding channel. Different values are required for different decoding channels. The value range is 0&#x2013;15. In this example code, this parameter is set to 0.
                                vdec_msg.channelId = 0;
                               // Call the VdecCtl interface for decoding.
                                if (0!= VdecCtl(pidvppapi_vdec, DVPP_CTL_VDEC_PROC, &amp;dvppApiCtlMsg, 0))
                                {
                                      printf(&quot;send stream data, call dvppctl process failed!\n&quot;);
                                }
                                rest_len=rest_len-len;
                         }
                        // The following lines actively set the EOS flag and send it by calling the VdecCtl interface. You do not need to set this parameter. If the flag is not set, the default setting is used in the DestroyVdecApi interface.
                         vdec_msg.isEOS = true;
                         if (0!= VdecCtl(pidvppapi_vdec, DVPP_CTL_VDEC_PROC, &amp;dvppApiCtlMsg, 0)
                                {
                                      printf(&quot;send eos flag, call dvppctl process failed!\n&quot;);
                                }
                        // Release the buffer.
                         free(vdec_msg.in_buffer);
                  }                                
            fclose(fp);
            }
           }
           DestroyVdecApi(pidvppapi_vdec, 0);
           DestroyDvppApi(pidvppapi_vpc);
           return ;
}
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="cmdlist.html" class="navigation navigation-prev " aria-label="Previous page: CMDLIST">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="jpege.html" class="navigation navigation-next " aria-label="Next page: JPEGE">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"VDEC","level":"1.3.2.4","depth":3,"next":{"title":"JPEGE","level":"1.3.2.5","depth":3,"path":"jpege.md","ref":"jpege.md","articles":[]},"previous":{"title":"CMDLIST","level":"1.3.2.3","depth":3,"path":"cmdlist.md","ref":"cmdlist.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"imgUrl":"","topnav":[]},"plugins":["expandable-chapters","copy"],"pluginsConfig":{"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"copy":{},"expandableChapters":{"cssFile":["expandable-chapters-theme.css"]},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"website.css"}},"file":{"path":"vdec.md","mtime":"2019-04-12T02:02:38.724Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-04-12T02:02:41.402Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-copy/js/clipboard.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-copy/js/copy.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

