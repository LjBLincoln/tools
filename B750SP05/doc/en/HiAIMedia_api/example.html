
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Example Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters-theme.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-copy/css/copy.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="appendix.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="introduction.html">
            
                <a href="introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="media-library-apis.html">
            
                <a href="media-library-apis.html">
            
                    
                    Media Library APIs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="medialibinit.html">
            
                <a href="medialibinit.html">
            
                    
                    MediaLibInit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="ischipalive.html">
            
                <a href="ischipalive.html">
            
                    
                    IsChipAlive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="querycameraids.html">
            
                <a href="querycameraids.html">
            
                    
                    QueryCameraIds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="querycamerastatus.html">
            
                <a href="querycamerastatus.html">
            
                    
                    QueryCameraStatus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="opencamera.html">
            
                <a href="opencamera.html">
            
                    
                    OpenCamera
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="setcameraproperty.html">
            
                <a href="setcameraproperty.html">
            
                    
                    SetCameraProperty
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="getcameraproperty.html">
            
                <a href="getcameraproperty.html">
            
                    
                    GetCameraProperty
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="capcamera.html">
            
                <a href="capcamera.html">
            
                    
                    CapCamera
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="readframefromcamera.html">
            
                <a href="readframefromcamera.html">
            
                    
                    ReadFrameFromCamera
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="closecamera.html">
            
                <a href="closecamera.html">
            
                    
                    CloseCamera
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="querymicstatus.html">
            
                <a href="querymicstatus.html">
            
                    
                    QueryMICStatus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="openmic.html">
            
                <a href="openmic.html">
            
                    
                    OpenMIC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.13" data-path="setmicproperty.html">
            
                <a href="setmicproperty.html">
            
                    
                    SetMICProperty
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.14" data-path="getmicproperty.html">
            
                <a href="getmicproperty.html">
            
                    
                    GetMICProperty
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.15" data-path="capmic.html">
            
                <a href="capmic.html">
            
                    
                    CapMIC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.16" data-path="readmicsound.html">
            
                <a href="readmicsound.html">
            
                    
                    ReadMicSound
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.17" data-path="closemic.html">
            
                <a href="closemic.html">
            
                    
                    CloseMIC
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="appendix.html">
            
                <a href="appendix.html">
            
                    
                    Appendix
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.4.1" data-path="example.html">
            
                <a href="example.html">
            
                    
                    Example
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Example</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="example">Example<a id="EN-US_TOPIC_0154783649"></a></h1>
<pre><code>#include &quot;stdio.h&quot;
#include &quot;stdlib.h&quot;
#include &lt;sys/types.h&gt;    
#include &lt;sys/stat.h&gt;    
#include &lt;fcntl.h&gt;
#include &quot;pthread.h&quot;
#include &lt;unistd.h&gt;
#include &quot;peripheral_api.h&quot;

int Camera0UserFunc(const void* pdata, int size, void* param)
{
// pdata is the pointer to the start address of the image memory. You are advised to read it directly without modifying it. If you need to modify it, you are advised to copy it to the user-defined memory space before the modification.
    printf(&quot;Camera0UserFunc Get frame size = %d\r\n&quot;, size);
    return 1;
}

int Camera1UserFunc(const void* pdata, int size, void* param)
{
// pdata is the pointer to the start address of the image memory. You are advised to read it directly without modifying it. If you need to modify it, you are advised to copy it to the user-defined memory space before the modification.
    printf(&quot;Camera1UserFunc Get frame size = %d\r\n&quot;, size);
    return 1;
}

int main()
{
    int ret;
    int para, i;
    unsigned char *framebuffer;
    int framebuffer_size;
    struct CameraResolution resolution;
    struct MICProperties micprop;
    struct CameraResolution supported_resolution[HIAI_MAX_CAMERARESOLUTION_COUNT];

// Initializes the media library.
    ret = MediaLibInit();
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;MediaLibInit failed %d\r\n&quot;, ret);
        return -1;
    }
    printf(&quot;MediaLibInit success %d\r\n&quot;, ret);

    ret = IsChipAlive(NULL);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;success failed %d\r\n&quot;, ret);
        return -1;
    }
    printf(&quot;IsChipAlive success ret %d\r\n&quot;, ret);

// Open the camera.
    ret = OpenCamera(0);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;OpenCamera 0 failed %d\r\n&quot;, ret);
        return -1;
    }
    ret = OpenCamera(1);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;OpenCamera 0 failed %d\r\n&quot;, ret);
        return -1;
    }

    ret = GetCameraProperty(0, CAMERA_PROP_SUPPORTED_RESOLUTION, supported_resolution);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;GetCameraProperty 0 failed %d\r\n&quot;, ret);
        return -1;
    }
    i = 0;
    do{
        printf(&quot;Camera0 supportted width = %d, height = %d\r\n&quot;, supported_resolution[i].width, supported_resolution[i].height);
        i++;
    }while(supported_resolution[i].width != -1);

    ret = GetCameraProperty(1, CAMERA_PROP_SUPPORTED_RESOLUTION, supported_resolution);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;GetCameraProperty 1 failed %d\r\n&quot;, ret);
        return -1;
    }
    i = 0;
    do{
        printf(&quot;Camera1 supportted width = %d, height = %d\r\n&quot;, supported_resolution[i].width, supported_resolution[i].height);
        i++;
    }while(supported_resolution[i].width != -1);

// Set the frame rate.
    para = 20;
    ret = SetCameraProperty(0, CAMERA_PROP_FPS, &amp;para);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;SetCameraProperty 0 failed %d\r\n&quot;, ret);
        return -1;
    }
    ret = SetCameraProperty(1, CAMERA_PROP_FPS, &amp;para);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;SetCameraProperty 0 failed %d\r\n&quot;, ret);
        return -1;
    }

    // Set the resolution.
    resolution.height = 1080;
    resolution.width = 1920;
    ret = SetCameraProperty(0, CAMERA_PROP_RESOLUTION, &amp;resolution);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;SetCameraProperty 0 failed %d\r\n&quot;, ret);
        return -1;
    }
    ret = SetCameraProperty(1, CAMERA_PROP_RESOLUTION, &amp;resolution);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;SetCameraProperty 1 failed %d\r\n&quot;, ret);
        return -1;
    }

    // Register the user-defined callback function.
    ret = CapCamera(0, Camera0UserFunc , NULL);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;CapCamera 0 failed %d\r\n&quot;, ret);
        return -1;
    }
    ret = CapCamera(1, Camera1UserFunc , NULL);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;CapCamera 1 failed %d\r\n&quot;, ret);
        return -1;
    }

    // Wait for 5s, which simulates the actual use process. 
    sleep(5);
    // Close the camera.
    ret = CloseCamera(0);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;CloseCamera 0 failed %d\r\n&quot;, ret);
        return -1;
    }
    printf(&quot;CloseCamera 1 success %d\r\n&quot;, ret);
    ret = CloseCamera(1);
    if(LIBMEDIA_STATUS_OK != ret) {
        printf(&quot;CloseCamera 1 failed %d\r\n&quot;, ret);
        return -1;
    }
    printf(&quot;CloseCamera 0 success %d\r\n&quot;, ret);

    return 0;
}
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="appendix.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Appendix">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Example","level":"1.4.1","depth":2,"previous":{"title":"Appendix","level":"1.4","depth":1,"path":"appendix.md","ref":"appendix.md","articles":[{"title":"Example","level":"1.4.1","depth":2,"path":"example.md","ref":"example.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"imgUrl":"","topnav":[]},"plugins":["expandable-chapters","copy"],"pluginsConfig":{"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"copy":{},"expandableChapters":{"cssFile":["expandable-chapters-theme.css"]},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"website.css"}},"file":{"path":"example.md","mtime":"2019-04-12T02:50:15.820Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-04-12T02:50:18.440Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-copy/js/clipboard.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-copy/js/copy.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

